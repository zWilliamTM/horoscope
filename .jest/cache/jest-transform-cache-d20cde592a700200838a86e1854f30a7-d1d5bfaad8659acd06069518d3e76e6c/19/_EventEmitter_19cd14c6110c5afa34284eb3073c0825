6524b1db5bc038de9c1899f14bbcd174
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _EmitterSubscription = _interopRequireDefault(require("./_EmitterSubscription"));

var _EventSubscriptionVendor = _interopRequireDefault(require("./_EventSubscriptionVendor"));

var invariant = require('invariant');

var sparseFilterPredicate = function sparseFilterPredicate() {
  return true;
};

var EventEmitter = function () {
  function EventEmitter(subscriber) {
    (0, _classCallCheck2.default)(this, EventEmitter);
    this._subscriber = subscriber || new _EventSubscriptionVendor.default();
  }

  (0, _createClass2.default)(EventEmitter, [{
    key: "addListener",
    value: function addListener(eventType, listener, context) {
      return this._subscriber.addSubscription(eventType, new _EmitterSubscription.default(this, this._subscriber, listener, context));
    }
  }, {
    key: "removeAllListeners",
    value: function removeAllListeners(eventType) {
      this._subscriber.removeAllSubscriptions(eventType);
    }
  }, {
    key: "removeSubscription",
    value: function removeSubscription(subscription) {
      invariant(subscription.emitter === this, 'Subscription does not belong to this emitter.');

      this._subscriber.removeSubscription(subscription);
    }
  }, {
    key: "listenerCount",
    value: function listenerCount(eventType) {
      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      return subscriptions ? subscriptions.filter(sparseFilterPredicate).length : 0;
    }
  }, {
    key: "emit",
    value: function emit(eventType) {
      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      if (subscriptions) {
        for (var i = 0, l = subscriptions.length; i < l; i++) {
          var subscription = subscriptions[i];

          if (subscription && subscription.listener) {
            subscription.listener.apply(subscription.context, Array.prototype.slice.call(arguments, 1));
          }
        }
      }
    }
  }, {
    key: "removeListener",
    value: function removeListener(eventType, listener) {
      var subscriptions = this._subscriber.getSubscriptionsForType(eventType);

      if (subscriptions) {
        for (var i = 0, l = subscriptions.length; i < l; i++) {
          var subscription = subscriptions[i];

          if (subscription && subscription.listener === listener) {
            subscription.remove();
          }
        }
      }
    }
  }]);
  return EventEmitter;
}();

module.exports = EventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9FdmVudEVtaXR0ZXIuanMiXSwibmFtZXMiOlsiaW52YXJpYW50IiwicmVxdWlyZSIsInNwYXJzZUZpbHRlclByZWRpY2F0ZSIsIkV2ZW50RW1pdHRlciIsInN1YnNjcmliZXIiLCJfc3Vic2NyaWJlciIsIkV2ZW50U3Vic2NyaXB0aW9uVmVuZG9yIiwiZXZlbnRUeXBlIiwibGlzdGVuZXIiLCJjb250ZXh0IiwiYWRkU3Vic2NyaXB0aW9uIiwiRW1pdHRlclN1YnNjcmlwdGlvbiIsInJlbW92ZUFsbFN1YnNjcmlwdGlvbnMiLCJzdWJzY3JpcHRpb24iLCJlbWl0dGVyIiwicmVtb3ZlU3Vic2NyaXB0aW9uIiwic3Vic2NyaXB0aW9ucyIsImdldFN1YnNjcmlwdGlvbnNGb3JUeXBlIiwiZmlsdGVyIiwibGVuZ3RoIiwiaSIsImwiLCJhcHBseSIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwicmVtb3ZlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBV0E7Ozs7Ozs7O0FBSUE7O0FBQ0E7O0FBSEEsSUFBTUEsU0FBUyxHQUFHQyxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFLQSxJQUFNQyxxQkFBcUIsR0FBRyxTQUF4QkEscUJBQXdCO0FBQUEsU0FBTSxJQUFOO0FBQUEsQ0FBOUI7O0lBZU1DLFk7QUFTSix3QkFBWUMsVUFBWixFQUFrRDtBQUFBO0FBQ2hELFNBQUtDLFdBQUwsR0FBbUJELFVBQVUsSUFBSSxJQUFJRSxnQ0FBSixFQUFqQztBQUNEOzs7O1dBZ0JELHFCQUNFQyxTQURGLEVBRUVDLFFBRkYsRUFHRUMsT0FIRixFQUl1QjtBQUNyQixhQUFRLEtBQUtKLFdBQUwsQ0FBaUJLLGVBQWpCLENBQ05ILFNBRE0sRUFFTixJQUFJSSw0QkFBSixDQUF3QixJQUF4QixFQUE4QixLQUFLTixXQUFuQyxFQUFnREcsUUFBaEQsRUFBMERDLE9BQTFELENBRk0sQ0FBUjtBQUlEOzs7V0FTRCw0QkFBbUJGLFNBQW5CLEVBQXVDO0FBQ3JDLFdBQUtGLFdBQUwsQ0FBaUJPLHNCQUFqQixDQUF3Q0wsU0FBeEM7QUFDRDs7O1dBTUQsNEJBQW1CTSxZQUFuQixFQUFzRDtBQUNwRGIsTUFBQUEsU0FBUyxDQUNQYSxZQUFZLENBQUNDLE9BQWIsS0FBeUIsSUFEbEIsRUFFUCwrQ0FGTyxDQUFUOztBQUlBLFdBQUtULFdBQUwsQ0FBaUJVLGtCQUFqQixDQUFvQ0YsWUFBcEM7QUFDRDs7O1dBU0QsdUJBQWNOLFNBQWQsRUFBeUM7QUFDdkMsVUFBTVMsYUFBYSxHQUFHLEtBQUtYLFdBQUwsQ0FBaUJZLHVCQUFqQixDQUF5Q1YsU0FBekMsQ0FBdEI7O0FBQ0EsYUFBT1MsYUFBYSxHQUtoQkEsYUFBYSxDQUFDRSxNQUFkLENBQXFCaEIscUJBQXJCLEVBQTRDaUIsTUFMNUIsR0FNaEIsQ0FOSjtBQU9EOzs7V0FnQkQsY0FBS1osU0FBTCxFQUF3QjtBQUN0QixVQUFNUyxhQUFhLEdBQUcsS0FBS1gsV0FBTCxDQUFpQlksdUJBQWpCLENBQXlDVixTQUF6QyxDQUF0Qjs7QUFDQSxVQUFJUyxhQUFKLEVBQW1CO0FBQ2pCLGFBQUssSUFBSUksQ0FBQyxHQUFHLENBQVIsRUFBV0MsQ0FBQyxHQUFHTCxhQUFhLENBQUNHLE1BQWxDLEVBQTBDQyxDQUFDLEdBQUdDLENBQTlDLEVBQWlERCxDQUFDLEVBQWxELEVBQXNEO0FBQ3BELGNBQU1QLFlBQVksR0FBR0csYUFBYSxDQUFDSSxDQUFELENBQWxDOztBQUdBLGNBQUlQLFlBQVksSUFBSUEsWUFBWSxDQUFDTCxRQUFqQyxFQUEyQztBQUN6Q0ssWUFBQUEsWUFBWSxDQUFDTCxRQUFiLENBQXNCYyxLQUF0QixDQUNFVCxZQUFZLENBQUNKLE9BRGYsRUFFRWMsS0FBSyxDQUFDQyxTQUFOLENBQWdCQyxLQUFoQixDQUFzQkMsSUFBdEIsQ0FBMkJDLFNBQTNCLEVBQXNDLENBQXRDLENBRkY7QUFJRDtBQUNGO0FBQ0Y7QUFDRjs7O1dBZUQsd0JBQWVwQixTQUFmLEVBQWtDQyxRQUFsQyxFQUE0QztBQUMxQyxVQUFNUSxhQUFhLEdBQUcsS0FBS1gsV0FBTCxDQUFpQlksdUJBQWpCLENBQXlDVixTQUF6QyxDQUF0Qjs7QUFDQSxVQUFJUyxhQUFKLEVBQW1CO0FBQ2pCLGFBQUssSUFBSUksQ0FBQyxHQUFHLENBQVIsRUFBV0MsQ0FBQyxHQUFHTCxhQUFhLENBQUNHLE1BQWxDLEVBQTBDQyxDQUFDLEdBQUdDLENBQTlDLEVBQWlERCxDQUFDLEVBQWxELEVBQXNEO0FBQ3BELGNBQU1QLFlBQVksR0FBR0csYUFBYSxDQUFDSSxDQUFELENBQWxDOztBQUlBLGNBQUlQLFlBQVksSUFBSUEsWUFBWSxDQUFDTCxRQUFiLEtBQTBCQSxRQUE5QyxFQUF3RDtBQUN0REssWUFBQUEsWUFBWSxDQUFDZSxNQUFiO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Y7Ozs7O0FBR0hDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjNCLFlBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAbm9mbG93XG4gKiBAdHlwZWNoZWNrXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdpbnZhcmlhbnQnKTtcblxuaW1wb3J0IEVtaXR0ZXJTdWJzY3JpcHRpb24gZnJvbSAnLi9fRW1pdHRlclN1YnNjcmlwdGlvbic7XG5pbXBvcnQgRXZlbnRTdWJzY3JpcHRpb25WZW5kb3IgZnJvbSAnLi9fRXZlbnRTdWJzY3JpcHRpb25WZW5kb3InO1xuXG5jb25zdCBzcGFyc2VGaWx0ZXJQcmVkaWNhdGUgPSAoKSA9PiB0cnVlO1xuXG4vKipcbiAqIEBjbGFzcyBFdmVudEVtaXR0ZXJcbiAqIEBkZXNjcmlwdGlvblxuICogQW4gRXZlbnRFbWl0dGVyIGlzIHJlc3BvbnNpYmxlIGZvciBtYW5hZ2luZyBhIHNldCBvZiBsaXN0ZW5lcnMgYW5kIHB1Ymxpc2hpbmdcbiAqIGV2ZW50cyB0byB0aGVtIHdoZW4gaXQgaXMgdG9sZCB0aGF0IHN1Y2ggZXZlbnRzIGhhcHBlbmVkLiBJbiBhZGRpdGlvbiB0byB0aGVcbiAqIGRhdGEgZm9yIHRoZSBnaXZlbiBldmVudCBpdCBhbHNvIHNlbmRzIGEgZXZlbnQgY29udHJvbCBvYmplY3Qgd2hpY2ggYWxsb3dzXG4gKiB0aGUgbGlzdGVuZXJzL2hhbmRsZXJzIHRvIHByZXZlbnQgdGhlIGRlZmF1bHQgYmVoYXZpb3Igb2YgdGhlIGdpdmVuIGV2ZW50LlxuICpcbiAqIFRoZSBlbWl0dGVyIGlzIGRlc2lnbmVkIHRvIGJlIGdlbmVyaWMgZW5vdWdoIHRvIHN1cHBvcnQgYWxsIHRoZSBkaWZmZXJlbnRcbiAqIGNvbnRleHRzIGluIHdoaWNoIG9uZSBtaWdodCB3YW50IHRvIGVtaXQgZXZlbnRzLiBJdCBpcyBhIHNpbXBsZSBtdWx0aWNhc3RcbiAqIG1lY2hhbmlzbSBvbiB0b3Agb2Ygd2hpY2ggZXh0cmEgZnVuY3Rpb25hbGl0eSBjYW4gYmUgY29tcG9zZWQuIEZvciBleGFtcGxlLCBhXG4gKiBtb3JlIGFkdmFuY2VkIGVtaXR0ZXIgbWF5IHVzZSBhbiBFdmVudEhvbGRlciBhbmQgRXZlbnRGYWN0b3J5LlxuICovXG5jbGFzcyBFdmVudEVtaXR0ZXIge1xuICBfc3Vic2NyaWJlcjogRXZlbnRTdWJzY3JpcHRpb25WZW5kb3I7XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50U3Vic2NyaXB0aW9uVmVuZG9yfSBzdWJzY3JpYmVyIC0gT3B0aW9uYWwgc3Vic2NyaWJlciBpbnN0YW5jZVxuICAgKiAgIHRvIHVzZS4gSWYgb21pdHRlZCwgYSBuZXcgc3Vic2NyaWJlciB3aWxsIGJlIGNyZWF0ZWQgZm9yIHRoZSBlbWl0dGVyLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioc3Vic2NyaWJlcjogP0V2ZW50U3Vic2NyaXB0aW9uVmVuZG9yKSB7XG4gICAgdGhpcy5fc3Vic2NyaWJlciA9IHN1YnNjcmliZXIgfHwgbmV3IEV2ZW50U3Vic2NyaXB0aW9uVmVuZG9yKCk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGxpc3RlbmVyIHRvIGJlIGludm9rZWQgd2hlbiBldmVudHMgb2YgdGhlIHNwZWNpZmllZCB0eXBlIGFyZVxuICAgKiBlbWl0dGVkLiBBbiBvcHRpb25hbCBjYWxsaW5nIGNvbnRleHQgbWF5IGJlIHByb3ZpZGVkLiBUaGUgZGF0YSBhcmd1bWVudHNcbiAgICogZW1pdHRlZCB3aWxsIGJlIHBhc3NlZCB0byB0aGUgbGlzdGVuZXIgZnVuY3Rpb24uXG4gICAqXG4gICAqIFRPRE86IEFubm90YXRlIHRoZSBsaXN0ZW5lciBhcmcncyB0eXBlLiBUaGlzIGlzIHRyaWNreSBiZWNhdXNlIGxpc3RlbmVyc1xuICAgKiAgICAgICBjYW4gYmUgaW52b2tlZCB3aXRoIHZhcmFyZ3MuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGUgLSBOYW1lIG9mIHRoZSBldmVudCB0byBsaXN0ZW4gdG9cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gbGlzdGVuZXIgLSBGdW5jdGlvbiB0byBpbnZva2Ugd2hlbiB0aGUgc3BlY2lmaWVkIGV2ZW50IGlzXG4gICAqICAgZW1pdHRlZFxuICAgKiBAcGFyYW0geyp9IGNvbnRleHQgLSBPcHRpb25hbCBjb250ZXh0IG9iamVjdCB0byB1c2Ugd2hlbiBpbnZva2luZyB0aGVcbiAgICogICBsaXN0ZW5lclxuICAgKi9cbiAgYWRkTGlzdGVuZXIoXG4gICAgZXZlbnRUeXBlOiBzdHJpbmcsXG4gICAgbGlzdGVuZXI6IEZ1bmN0aW9uLFxuICAgIGNvbnRleHQ6ID9PYmplY3QsXG4gICk6IEVtaXR0ZXJTdWJzY3JpcHRpb24ge1xuICAgIHJldHVybiAodGhpcy5fc3Vic2NyaWJlci5hZGRTdWJzY3JpcHRpb24oXG4gICAgICBldmVudFR5cGUsXG4gICAgICBuZXcgRW1pdHRlclN1YnNjcmlwdGlvbih0aGlzLCB0aGlzLl9zdWJzY3JpYmVyLCBsaXN0ZW5lciwgY29udGV4dCksXG4gICAgKTogYW55KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGFsbCBvZiB0aGUgcmVnaXN0ZXJlZCBsaXN0ZW5lcnMsIGluY2x1ZGluZyB0aG9zZSByZWdpc3RlcmVkIGFzXG4gICAqIGxpc3RlbmVyIG1hcHMuXG4gICAqXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gZXZlbnRUeXBlIC0gT3B0aW9uYWwgbmFtZSBvZiB0aGUgZXZlbnQgd2hvc2UgcmVnaXN0ZXJlZFxuICAgKiAgIGxpc3RlbmVycyB0byByZW1vdmVcbiAgICovXG4gIHJlbW92ZUFsbExpc3RlbmVycyhldmVudFR5cGU6ID9zdHJpbmcpIHtcbiAgICB0aGlzLl9zdWJzY3JpYmVyLnJlbW92ZUFsbFN1YnNjcmlwdGlvbnMoZXZlbnRUeXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGEgc3BlY2lmaWMgc3Vic2NyaXB0aW9uLiBDYWxsZWQgYnkgdGhlIGByZW1vdmUoKWAgbWV0aG9kIG9mIHRoZVxuICAgKiBzdWJzY3JpcHRpb24gaXRzZWxmIHRvIGVuc3VyZSBhbnkgbmVjZXNzYXJ5IGNsZWFudXAgaXMgcGVyZm9ybWVkLlxuICAgKi9cbiAgcmVtb3ZlU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbjogRW1pdHRlclN1YnNjcmlwdGlvbikge1xuICAgIGludmFyaWFudChcbiAgICAgIHN1YnNjcmlwdGlvbi5lbWl0dGVyID09PSB0aGlzLFxuICAgICAgJ1N1YnNjcmlwdGlvbiBkb2VzIG5vdCBiZWxvbmcgdG8gdGhpcyBlbWl0dGVyLicsXG4gICAgKTtcbiAgICB0aGlzLl9zdWJzY3JpYmVyLnJlbW92ZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBsaXN0ZW5lcnMgdGhhdCBhcmUgY3VycmVudGx5IHJlZ2lzdGVyZWQgZm9yIHRoZSBnaXZlblxuICAgKiBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZSAtIE5hbWUgb2YgdGhlIGV2ZW50IHRvIHF1ZXJ5XG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBsaXN0ZW5lckNvdW50KGV2ZW50VHlwZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gdGhpcy5fc3Vic2NyaWJlci5nZXRTdWJzY3JpcHRpb25zRm9yVHlwZShldmVudFR5cGUpO1xuICAgIHJldHVybiBzdWJzY3JpcHRpb25zXG4gICAgICA/IC8vIFdlIGZpbHRlciBvdXQgbWlzc2luZyBlbnRyaWVzIGJlY2F1c2UgdGhlIGFycmF5IGlzIHNwYXJzZS5cbiAgICAgICAgLy8gXCJjYWxsYmFja2ZuIGlzIGNhbGxlZCBvbmx5IGZvciBlbGVtZW50cyBvZiB0aGUgYXJyYXkgd2hpY2ggYWN0dWFsbHlcbiAgICAgICAgLy8gZXhpc3Q7IGl0IGlzIG5vdCBjYWxsZWQgZm9yIG1pc3NpbmcgZWxlbWVudHMgb2YgdGhlIGFycmF5LlwiXG4gICAgICAgIC8vIGh0dHBzOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvOS4wL2luZGV4Lmh0bWwjc2VjLWFycmF5LnByb3RvdHlwZS5maWx0ZXJcbiAgICAgICAgc3Vic2NyaXB0aW9ucy5maWx0ZXIoc3BhcnNlRmlsdGVyUHJlZGljYXRlKS5sZW5ndGhcbiAgICAgIDogMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhbiBldmVudCBvZiB0aGUgZ2l2ZW4gdHlwZSB3aXRoIHRoZSBnaXZlbiBkYXRhLiBBbGwgaGFuZGxlcnMgb2YgdGhhdFxuICAgKiBwYXJ0aWN1bGFyIHR5cGUgd2lsbCBiZSBub3RpZmllZC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZSAtIE5hbWUgb2YgdGhlIGV2ZW50IHRvIGVtaXRcbiAgICogQHBhcmFtIHsuLi4qfSBBcmJpdHJhcnkgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCB0byBlYWNoIHJlZ2lzdGVyZWQgbGlzdGVuZXJcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogICBlbWl0dGVyLmFkZExpc3RlbmVyKCdzb21lRXZlbnQnLCBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAqICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICogICB9KTtcbiAgICpcbiAgICogICBlbWl0dGVyLmVtaXQoJ3NvbWVFdmVudCcsICdhYmMnKTsgLy8gbG9ncyAnYWJjJ1xuICAgKi9cbiAgZW1pdChldmVudFR5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbnMgPSB0aGlzLl9zdWJzY3JpYmVyLmdldFN1YnNjcmlwdGlvbnNGb3JUeXBlKGV2ZW50VHlwZSk7XG4gICAgaWYgKHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3Vic2NyaXB0aW9ucy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gc3Vic2NyaXB0aW9uc1tpXTtcblxuICAgICAgICAvLyBUaGUgc3Vic2NyaXB0aW9uIG1heSBoYXZlIGJlZW4gcmVtb3ZlZCBkdXJpbmcgdGhpcyBldmVudCBsb29wLlxuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uICYmIHN1YnNjcmlwdGlvbi5saXN0ZW5lcikge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbi5saXN0ZW5lci5hcHBseShcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jb250ZXh0LFxuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIGdpdmVuIGxpc3RlbmVyIGZvciBldmVudCBvZiBzcGVjaWZpYyB0eXBlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlIC0gTmFtZSBvZiB0aGUgZXZlbnQgdG8gZW1pdFxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBsaXN0ZW5lciAtIEZ1bmN0aW9uIHRvIGludm9rZSB3aGVuIHRoZSBzcGVjaWZpZWQgZXZlbnQgaXNcbiAgICogICBlbWl0dGVkXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignc29tZUV2ZW50JywgZnVuY3Rpb24obWVzc2FnZSkge1xuICAgKiAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAqICAgfSk7IC8vIHJlbW92ZXMgdGhlIGxpc3RlbmVyIGlmIGFscmVhZHkgcmVnaXN0ZXJlZFxuICAgKlxuICAgKi9cbiAgcmVtb3ZlTGlzdGVuZXIoZXZlbnRUeXBlOiBTdHJpbmcsIGxpc3RlbmVyKSB7XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHRoaXMuX3N1YnNjcmliZXIuZ2V0U3Vic2NyaXB0aW9uc0ZvclR5cGUoZXZlbnRUeXBlKTtcbiAgICBpZiAoc3Vic2NyaXB0aW9ucykge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzdWJzY3JpcHRpb25zLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb25zW2ldO1xuXG4gICAgICAgIC8vIFRoZSBzdWJzY3JpcHRpb24gbWF5IGhhdmUgYmVlbiByZW1vdmVkIGR1cmluZyB0aGlzIGV2ZW50IGxvb3AuXG4gICAgICAgIC8vIGl0cyBsaXN0ZW5lciBtYXRjaGVzIHRoZSBsaXN0ZW5lciBpbiBtZXRob2QgcGFyYW1ldGVyc1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uICYmIHN1YnNjcmlwdGlvbi5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgICBzdWJzY3JpcHRpb24ucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG4iXX0=